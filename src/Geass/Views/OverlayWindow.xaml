<Window x:Class="Geass.Views.OverlayWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="clr-namespace:Geass.ViewModels"
        Width="300" Height="72"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        ShowInTaskbar="False"
        Topmost="True"
        ShowActivated="False"
        ResizeMode="NoResize"
        WindowStartupLocation="Manual">

    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/Resources/Colors.xaml" />
                <ResourceDictionary Source="/Resources/Animations.xaml" />
            </ResourceDictionary.MergedDictionaries>

            <BooleanToVisibilityConverter x:Key="BoolToVisibility" />
        </ResourceDictionary>
    </Window.Resources>

    <Border x:Name="RootBorder"
            CornerRadius="20"
            RenderTransformOrigin="0.5,0.5"
            Margin="8">
        <Border.RenderTransform>
            <TranslateTransform />
        </Border.RenderTransform>

        <Border.Background>
            <SolidColorBrush Color="#E62D2D2F" />
        </Border.Background>

        <Border.Effect>
            <DropShadowEffect BlurRadius="20"
                              Opacity="0.25"
                              Direction="270"
                              ShadowDepth="4"
                              Color="#000000" />
        </Border.Effect>

        <Grid>
            <!-- Recording State: Audio waveform bars -->
            <StackPanel x:Name="RecordingPanel"
                        Orientation="Horizontal"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        Visibility="{Binding IsRecording, Converter={StaticResource BoolToVisibility}}">

                <!-- Waveform bars -->
                <Canvas Width="48" Height="28" Margin="0,0,12,0">
                    <Border x:Name="Bar1" Canvas.Left="0" Canvas.Bottom="0"
                            Width="4" Height="8" CornerRadius="2"
                            Background="{StaticResource AccentBrush}" />
                    <Border x:Name="Bar2" Canvas.Left="8" Canvas.Bottom="0"
                            Width="4" Height="14" CornerRadius="2"
                            Background="{StaticResource AccentBrush}" />
                    <Border x:Name="Bar3" Canvas.Left="16" Canvas.Bottom="0"
                            Width="4" Height="20" CornerRadius="2"
                            Background="{StaticResource AccentBrush}" />
                    <Border x:Name="Bar4" Canvas.Left="24" Canvas.Bottom="0"
                            Width="4" Height="12" CornerRadius="2"
                            Background="{StaticResource AccentBrush}" />
                    <Border x:Name="Bar5" Canvas.Left="32" Canvas.Bottom="0"
                            Width="4" Height="18" CornerRadius="2"
                            Background="{StaticResource AccentBrush}" />
                    <Border x:Name="Bar6" Canvas.Left="40" Canvas.Bottom="0"
                            Width="4" Height="10" CornerRadius="2"
                            Background="{StaticResource AccentBrush}" />
                </Canvas>

                <!-- Recording dot + text -->
                <Ellipse x:Name="RecDot" Width="8" Height="8"
                         Fill="#FF4D4D" Margin="0,0,8,0"
                         VerticalAlignment="Center" />
                <TextBlock Text="Listening..."
                           Foreground="#DDFFFFFF"
                           FontSize="14"
                           VerticalAlignment="Center"
                           FontFamily="Segoe UI Variable, Segoe UI, sans-serif"
                           FontWeight="Medium" />
            </StackPanel>

            <!-- Processing State: Gradient spinner -->
            <StackPanel x:Name="ProcessingPanel"
                        Orientation="Horizontal"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        Visibility="{Binding IsProcessing, Converter={StaticResource BoolToVisibility}}">
                <Path x:Name="Spinner"
                      Width="20" Height="20"
                      Stretch="Uniform"
                      StrokeThickness="2.5"
                      StrokeStartLineCap="Round"
                      StrokeEndLineCap="Round"
                      Data="M 10,1 A 9,9 0 1 1 1,10"
                      Margin="0,0,10,0"
                      RenderTransformOrigin="0.5,0.5">
                    <Path.Stroke>
                        <SolidColorBrush Color="{StaticResource AccentColor}" />
                    </Path.Stroke>
                    <Path.RenderTransform>
                        <RotateTransform />
                    </Path.RenderTransform>
                </Path>
                <TextBlock Text="Processing..."
                           Foreground="#DDFFFFFF"
                           FontSize="14"
                           VerticalAlignment="Center"
                           FontFamily="Segoe UI Variable, Segoe UI, sans-serif"
                           FontWeight="Medium" />
            </StackPanel>
        </Grid>
    </Border>
</Window>
